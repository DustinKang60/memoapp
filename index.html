<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <meta name="theme-color" content="#0f1117"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="apple-mobile-web-app-title" content="ë©”ëª¨ì¥"/>
  <meta name="mobile-web-app-capable" content="yes"/>
  <title>ë©”ëª¨ì¥</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Noto+Serif+KR:wght@400;700&family=Gothic+A1:wght@400;700&family=Jua&family=Cute+Font&display=swap" rel="stylesheet"/>
  <script>
    // ì•„ì´ì½˜ (apple touch iconìš©)
    const ICON_URL = "/memoapp/icons/icon-192x192.png";
    const al = document.createElement("link");
    al.rel="apple-touch-icon"; al.href=ICON_URL;
    document.head.appendChild(al);
  </script>
  <link rel="manifest" href="/memoapp/manifest.json"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    /* í•µì‹¬: html/bodyëŠ” ê·¸ëƒ¥ 100% - position:fixed ì ˆëŒ€ ê¸ˆì§€ */
    html { height: 100%; background: #0f1117; }
    body { height: 100%; background: #0f1117; font-family: 'Noto Sans KR', sans-serif; }
    #root { height: 100%; }
    /* ì…ë ¥ì°½ font-size 16px í•„ìˆ˜ - ë¯¸ë§Œì´ë©´ ì•ˆë“œë¡œì´ë“œ ìë™ì¤Œ í›„ í‚¤ë³´ë“œ íŠ•ê¹€ */
    input, textarea, select {
      -webkit-appearance: none;
      font-size: 16px;
      font-family: inherit;
    }
    ::-webkit-scrollbar { width: 3px; }
    ::-webkit-scrollbar-thumb { background: #2d3154; border-radius: 2px; }
    -webkit-tap-highlight-color: transparent;
  </style>
</head>
<body>
<div id="root"></div>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script type="text/babel" data-presets="react">
const { useState, useRef, useEffect, useCallback } = React;

// â”€â”€â”€ ìƒìˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const STORAGE_KEY  = "memoapp_memos_v3";
const SETTINGS_KEY = "memoapp_settings_v3";
const DEFAULT_CATS = ["ë©”ëª¨","ì¼ê¸°","ì•„ì´ë””ì–´","ì—…ë¬´","ì•½ì†"];
const CAT_META = {
  "ë©”ëª¨":     { icon:"ğŸ“", color:"#60a5fa" },
  "ì¼ê¸°":     { icon:"ğŸ“–", color:"#f472b6" },
  "ì•„ì´ë””ì–´": { icon:"ğŸ’¡", color:"#fbbf24" },
  "ì—…ë¬´":     { icon:"ğŸ’¼", color:"#34d399" },
  "ì•½ì†":     { icon:"ğŸ“…", color:"#a78bfa" },
};
const DAYS_KR = ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];
const FONTS = ["Noto Sans KR","Noto Serif KR","Gothic A1","Jua","Cute Font"];
const WMO = {
  0:{icon:"â˜€ï¸",label:"ë§‘ìŒ"}, 1:{icon:"ğŸŒ¤ï¸",label:"ëŒ€ì²´ë¡œ ë§‘ìŒ"},
  2:{icon:"â›…",label:"êµ¬ë¦„ì¡°ê¸ˆ"}, 3:{icon:"â˜ï¸",label:"íë¦¼"},
  45:{icon:"ğŸŒ«ï¸",label:"ì•ˆê°œ"}, 48:{icon:"ğŸŒ«ï¸",label:"ì•ˆê°œ"},
  51:{icon:"ğŸŒ¦ï¸",label:"ì´ìŠ¬ë¹„"}, 53:{icon:"ğŸŒ¦ï¸",label:"ì´ìŠ¬ë¹„"}, 55:{icon:"ğŸŒ§ï¸",label:"ì´ìŠ¬ë¹„(ê°•)"},
  61:{icon:"ğŸŒ§ï¸",label:"ë¹„"}, 63:{icon:"ğŸŒ§ï¸",label:"ë¹„(ì¤‘)"}, 65:{icon:"ğŸŒ§ï¸",label:"ë¹„(ê°•)"},
  71:{icon:"ğŸŒ¨ï¸",label:"ëˆˆ"}, 73:{icon:"ğŸŒ¨ï¸",label:"ëˆˆ(ì¤‘)"}, 75:{icon:"â„ï¸",label:"ëˆˆ(ê°•)"},
  80:{icon:"ğŸŒ¦ï¸",label:"ì†Œë‚˜ê¸°"}, 95:{icon:"â›ˆï¸",label:"ë‡Œìš°"}, 99:{icon:"â›ˆï¸",label:"ë‡Œìš°+ìš°ë°•"},
};
const getWMO = c => WMO[c] || { icon:"ğŸŒ¡ï¸", label:"ì•Œ ìˆ˜ ì—†ìŒ" };

function fmtDate(d) {
  const y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,"0"),
        dd=String(d.getDate()).padStart(2,"0"), day=DAYS_KR[d.getDay()];
  return `${y}-${m}-${dd} (${day}ìš”ì¼)`;
}
function sameDay(a,b) {
  return a.getFullYear()===b.getFullYear() &&
         a.getMonth()===b.getMonth() &&
         a.getDate()===b.getDate();
}
function dKey(d) { return `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}`; }

// â”€â”€â”€ Storage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function loadMemos() {
  try {
    const r = localStorage.getItem(STORAGE_KEY);
    return r ? JSON.parse(r).map(m=>({...m, date:new Date(m.date)})) : [];
  } catch { return []; }
}
function saveMemos(ms) { localStorage.setItem(STORAGE_KEY, JSON.stringify(ms)); }
function loadSettings() {
  try { const r=localStorage.getItem(SETTINGS_KEY); return r?JSON.parse(r):null; }
  catch { return null; }
}
function saveSettings(s) { localStorage.setItem(SETTINGS_KEY, JSON.stringify(s)); }

// â”€â”€â”€ ë‚ ì”¨ í›… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function useWeather() {
  const [w, setW]       = useState(null);
  const [loading, setL] = useState(false);
  const [error, setE]   = useState(null);
  const cache = useRef({});

  const fetch_ = useCallback(async () => {
    setL(true); setE(null);
    try {
      const pos = await new Promise((res,rej) =>
        navigator.geolocation.getCurrentPosition(res, rej, { timeout:8000 })
      );
      const { latitude:lat, longitude:lon } = pos.coords;
      const ck = `${Math.round(lat*10)}_${Math.round(lon*10)}`;
      if (cache.current[ck] && Date.now()-cache.current[ck].ts < 3600000) {
        setW(cache.current[ck].data); setL(false); return;
      }
      let city = "";
      try {
        const gr = await fetch(
          `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json&accept-language=ko`,
          { headers:{ "User-Agent":"MemoApp/1.0" } }
        );
        const gd = await gr.json();
        city = gd.address?.city || gd.address?.town || gd.address?.county || "";
      } catch {}
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=auto&forecast_days=1`;
      const res  = await fetch(url);
      const data = await res.json();
      const code = data.daily.weathercode[0];
      const result = {
        ...getWMO(code),
        tmin: Math.round(data.daily.temperature_2m_min[0]),
        tmax: Math.round(data.daily.temperature_2m_max[0]),
        city
      };
      cache.current[ck] = { data:result, ts:Date.now() };
      setW(result);
    } catch(e) {
      setE(e.code===1 ? "ìœ„ì¹˜ ê¶Œí•œ í•„ìš”" : "ë‚ ì”¨ ì˜¤ë¥˜");
    }
    setL(false);
  }, []);

  return { weather:w, loading, error, fetchWeather:fetch_ };
}

// â”€â”€â”€ ìº˜ë¦°ë” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Calendar({ memos, onDateClick, c, font }) {
  const [cur, setCur] = useState(new Date());
  const y=cur.getFullYear(), mo=cur.getMonth();
  const first=new Date(y,mo,1).getDay();
  const days=new Date(y,mo+1,0).getDate();
  const cells=[];
  for(let i=0;i<first;i++) cells.push(null);
  for(let d=1;d<=days;d++) cells.push(d);
  const mp={};
  memos.forEach(m => { mp[dKey(m.date)]=true; });

  return (
    <div style={{background:c.surface,borderRadius:16,padding:"12px",
      marginBottom:12,border:`1px solid ${c.border}`}}>
      <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8}}>
        <button onClick={()=>setCur(new Date(y,mo-1,1))}
          style={{background:"none",border:"none",color:c.muted,fontSize:22,
            cursor:"pointer",padding:"0 10px",lineHeight:1}}>â€¹</button>
        <span style={{color:c.text,fontWeight:700,fontSize:14,fontFamily:`'${font}',sans-serif`}}>
          {y}ë…„ {mo+1}ì›”
        </span>
        <button onClick={()=>setCur(new Date(y,mo+1,1))}
          style={{background:"none",border:"none",color:c.muted,fontSize:22,
            cursor:"pointer",padding:"0 10px",lineHeight:1}}>â€º</button>
      </div>
      <div style={{display:"grid",gridTemplateColumns:"repeat(7,1fr)",marginBottom:2}}>
        {["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "].map((d,i)=>(
          <div key={d} style={{textAlign:"center",fontSize:11,padding:"2px 0",
            color:i===0?"#ef4444":i===6?"#60a5fa":c.muted}}>{d}</div>
        ))}
      </div>
      <div style={{display:"grid",gridTemplateColumns:"repeat(7,1fr)",gap:2}}>
        {cells.map((day,i)=>{
          const isToday = day && sameDay(new Date(y,mo,day), new Date());
          const has = day && mp[dKey(new Date(y,mo,day))];
          return (
            <div key={i} onClick={()=>day&&onDateClick(new Date(y,mo,day))}
              style={{textAlign:"center",borderRadius:8,padding:"2px 0",
                cursor:day?"pointer":"default",
                background:isToday?"#3b82f6":"transparent"}}>
              {day && <>
                <div style={{fontSize:13,lineHeight:"1.6",fontWeight:isToday?700:400,
                  color:isToday?"#fff":i%7===0?"#ef4444":i%7===6?"#60a5fa":c.text}}>{day}</div>
                <div style={{height:4,display:"flex",justifyContent:"center",alignItems:"center"}}>
                  {has && <div style={{width:4,height:4,borderRadius:"50%",background:"#f472b6"}}/>}
                </div>
              </>}
            </div>
          );
        })}
      </div>
    </div>
  );
}

// â”€â”€â”€ ë©”ì¸ ì•± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function App() {
  const saved = loadSettings();
  const [isDark,   setIsDark]   = useState(saved?.isDark   ?? true);
  const [font,     setFont]     = useState(saved?.font     ?? "Noto Sans KR");
  const [fSize,    setFSize]    = useState(saved?.fontSize  ?? 15);
  const [cats,     setCats]     = useState(saved?.categories ?? DEFAULT_CATS);
  const [memos,    setMemos]    = useState(loadMemos);
  const [screen,   setScreen]   = useState("main");
  const [catPop,   setCatPop]   = useState(false);
  const [selDate,  setSelDate]  = useState(null);
  const [query,    setQuery]    = useState("");
  const [editMemo, setEditMemo] = useState(null);
  const [wCat,     setWCat]     = useState("");
  const [wTitle,   setWTitle]   = useState("");
  const [wContent, setWContent] = useState("");
  const [wImages,  setWImages]  = useState([]);
  const [wApptDate,setWApptDate]= useState(""); // ì•½ì† ë‚ ì§œ
  const [wApptTime,setWApptTime]= useState(""); // ì•½ì† ì‹œê°„
  const [newCat,   setNewCat]   = useState("");
  const [filterCat,setFilterCat]= useState("ì „ì²´"); // ê²€ìƒ‰ ì¹´í…Œê³ ë¦¬ í•„í„°
  const { weather, loading:wLoad, error:wErr, fetchWeather } = useWeather();
  const fileRef = useRef();

  useEffect(()=>{ saveSettings({isDark,font,fontSize:fSize,categories:cats}); },[isDark,font,fSize,cats]);
  useEffect(()=>{ saveMemos(memos); },[memos]);

  // íŒ”ë ˆíŠ¸
  const c = {
    bg:      isDark ? "#0f1117" : "#f4f7ff",
    surface: isDark ? "#1a1d2e" : "#ffffff",
    surface2:isDark ? "#252840" : "#eef1fb",
    border:  isDark ? "#2d3154" : "#dde3f5",
    text:    isDark ? "#e2e8f0" : "#1a1a2e",
    muted:   isDark ? "#64748b" : "#8896b3",
    accent:  "#3b82f6",
    danger:  "#ef4444",
  };
  const ff = `'${font}', sans-serif`;

  // CRUD
  function startWrite(cat, date=null) {
    setWCat(cat); setWTitle(""); setWContent(""); setWImages([]);
    setWApptDate(""); setWApptTime("");
    setSelDate(date||new Date()); setEditMemo(null);
    setCatPop(false); setScreen("write");
  }
  function openEdit(memo) {
    setEditMemo(memo); setWCat(memo.category); setWTitle(memo.title);
    setWContent(memo.content); setWImages(memo.images||[]); setSelDate(memo.date);
    setWApptDate(memo.apptDate||""); setWApptTime(memo.apptTime||"");
    setScreen("write");
  }
  function doSave() {
    if (!wTitle.trim() && !wContent.trim()) return;
    const m = {
      id: editMemo?.id || Date.now(),
      category: wCat, date: selDate||new Date(),
      title: wTitle||"(ì œëª© ì—†ìŒ)", content: wContent,
      weather: wCat==="ì¼ê¸°" ? weather : undefined,
      images: wImages,
      apptDate: wCat==="ì•½ì†" ? wApptDate : undefined,
      apptTime: wCat==="ì•½ì†" ? wApptTime : undefined,
    };
    setMemos(p => editMemo ? p.map(x=>x.id===m.id?m:x) : [m,...p]);
    // ì•½ì† ì•Œë¦¼ ë“±ë¡
    if (wCat==="ì•½ì†" && wApptDate && wApptTime) {
      scheduleApptNotif(m);
    }
    setScreen("main");
  }

  function scheduleApptNotif(m) {
    if (!("Notification" in window)) return;
    Notification.requestPermission().then(perm => {
      if (perm !== "granted") return;
      const apptMs = new Date(`${m.apptDate}T${m.apptTime}`).getTime();
      const notifMs = apptMs - 60*60*1000; // 1ì‹œê°„ ì „
      const delay = notifMs - Date.now();
      if (delay <= 0) return;
      setTimeout(()=>{
        new Notification("â° ì•½ì† 1ì‹œê°„ ì „!", {
          body: m.title,
          icon: "/memoapp/icons/icon-192x192.png",
        });
      }, delay);
    });
  }
  function doDelete(id) {
    const target = memos.find(x=>x.id===id);
    const title = target?.title || "(ì œëª© ì—†ìŒ)";
    if (!window.confirm(`"${title}"\n\nì´ ë©”ëª¨ë¥¼ ì‚­ì œí• ê¹Œìš”?`)) return;
    setMemos(p=>p.filter(x=>x.id!==id)); setScreen("main");
  }
  function doShare(m) {
    const cat = CAT_META[m.category];
    const weatherLine = m.weather
      ? `\në‚ ì”¨: ${m.weather.icon} ${m.weather.label} ${m.weather.tmin}Â°~${m.weather.tmax}Â°C`
      : "";
    const apptLine = (m.apptDate && m.apptTime)
      ? `\nì•½ì†ì¼ì‹œ: ${m.apptDate} ${m.apptTime}`
      : "";
    const txt = [
      fmtDate(m.date),
      `[${cat?.icon||""}${m.category}] ${m.title}`,
      weatherLine ? weatherLine.trim() : null,
      apptLine ? apptLine.trim() : null,
      m.content,
      "- ì‘ì€ì•±ê³µë°© ë©”ëª¨ì¥",
    ].filter(Boolean).join("\n\n");
    if (navigator.share) navigator.share({title:m.title, text:txt});
    else { navigator.clipboard?.writeText(txt); alert("í´ë¦½ë³´ë“œì— ë³µì‚¬ëì–´ìš”!"); }
  }
  function onImg(e) {
    Array.from(e.target.files).forEach(f=>{
      const r=new FileReader();
      r.onload=ev=>setWImages(p=>[...p,ev.target.result]);
      r.readAsDataURL(f);
    });
  }

  const filtered = memos
    .filter(m=>{
      const qOk = !query.trim() || (m.title+m.content).includes(query);
      const cOk = filterCat==="ì „ì²´" || m.category===filterCat;
      return qOk && cOk;
    })
    .sort((a,b)=>b.date-a.date);

  // â”€â”€ ê³µí†µ UI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const TopBar = ({left,title,right}) => (
    <div style={{background:c.surface,borderBottom:`1px solid ${c.border}`,
      padding:"0 16px",height:52,display:"flex",alignItems:"center",
      justifyContent:"space-between",flexShrink:0}}>
      <div style={{minWidth:64}}>{left}</div>
      <span style={{fontFamily:ff,fontWeight:700,fontSize:17,color:c.text}}>{title}</span>
      <div style={{minWidth:64,display:"flex",justifyContent:"flex-end",gap:4}}>{right}</div>
    </div>
  );
  const IBtn = ({ch,onClick,active=false}) => (
    <button onClick={onClick}
      style={{background:"none",border:"none",cursor:"pointer",padding:"6px",
        color:active?c.accent:c.muted,fontSize:22,lineHeight:1,display:"flex",alignItems:"center"}}>
      {ch}
    </button>
  );
  const PBtn = ({ch,onClick,style:s={}}) => (
    <button onClick={onClick}
      style={{background:c.accent,color:"#fff",border:"none",borderRadius:10,
        padding:"10px 18px",cursor:"pointer",fontFamily:ff,fontSize:15,fontWeight:600,...s}}>
      {ch}
    </button>
  );
  const GBtn = ({ch,onClick,style:s={}}) => (
    <button onClick={onClick}
      style={{background:c.surface2,color:c.text,border:`1px solid ${c.border}`,
        borderRadius:10,padding:"10px 16px",cursor:"pointer",fontFamily:ff,fontSize:15,...s}}>
      {ch}
    </button>
  );

  // ë‚ ì”¨ ë°°ì§€
  const WBadge = () => {
    if (wLoad) return (
      <div style={{padding:"10px 14px",background:c.surface2,borderRadius:12,
        fontSize:14,color:c.muted,border:`1px solid ${c.border}`,display:"inline-block"}}>
        ğŸŒ€ ë‚ ì”¨ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
      </div>
    );
    if (wErr) return (
      <button onClick={fetchWeather}
        style={{padding:"10px 14px",background:c.surface2,borderRadius:12,
          fontSize:13,color:c.muted,border:`1px solid ${c.border}`,cursor:"pointer",fontFamily:ff}}>
        âš ï¸ {wErr} Â· ë‹¤ì‹œ ì‹œë„
      </button>
    );
    if (!weather) return (
      <button onClick={fetchWeather}
        style={{padding:"10px 14px",background:c.surface2,borderRadius:12,
          fontSize:14,color:c.muted,border:`1px solid ${c.border}`,cursor:"pointer",
          fontFamily:ff,display:"inline-flex",alignItems:"center",gap:8}}>
        <span>ğŸ“</span> ë‚ ì”¨ ë¶ˆëŸ¬ì˜¤ê¸°
      </button>
    );
    return (
      <div style={{display:"inline-flex",alignItems:"center",gap:10,
        padding:"10px 16px",background:isDark?"rgba(59,130,246,0.12)":"#dbeafe",
        borderRadius:14,border:`1px solid ${isDark?"rgba(59,130,246,0.3)":"#bfdbfe"}`}}>
        <span style={{fontSize:28}}>{weather.icon}</span>
        <div>
          <div style={{fontSize:14,fontWeight:700,color:c.text,fontFamily:ff}}>{weather.label}</div>
          <div style={{fontSize:12,color:c.muted}}>
            {weather.city&&`${weather.city} Â· `}{weather.tmin}Â° ~ {weather.tmax}Â°C
          </div>
        </div>
      </div>
    );
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ë©”ì¸ í™”ë©´
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (screen==="main" || screen==="search") return (
    <div style={{fontFamily:ff,background:c.bg,color:c.text,
      width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"}}>

      <TopBar
        left={<span style={{fontSize:22}}>ğŸ““</span>}
        title="ë©”ëª¨ì¥"
        right={<>
          <IBtn ch="ğŸ”" onClick={()=>setScreen(s=>s==="search"?"main":"search")} active={screen==="search"}/>
          <IBtn ch="âš™ï¸" onClick={()=>setScreen("settings")}/>
        </>}
      />

      {/* ê²€ìƒ‰ë°” + ì¹´í…Œê³ ë¦¬ í•„í„° */}
      {screen==="search" && (
        <div style={{background:c.surface,borderBottom:`1px solid ${c.border}`,flexShrink:0}}>
          <div style={{padding:"10px 16px",display:"flex",gap:8,alignItems:"center"}}>
            <input autoFocus value={query} onChange={e=>setQuery(e.target.value)}
              onKeyDown={e=>{ if(e.key==="Enter") e.target.blur(); }}
              placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
              style={{flex:1,background:c.surface2,border:`1px solid ${c.border}`,
                borderRadius:10,padding:"10px 14px",color:c.text,fontFamily:ff,outline:"none"}}/>
            <button onClick={()=>document.activeElement?.blur()}
              style={{background:c.accent,color:"#fff",border:"none",borderRadius:10,
                padding:"10px 16px",cursor:"pointer",fontFamily:ff,fontWeight:700,
                fontSize:14,flexShrink:0}}>ê²€ìƒ‰</button>
          </div>
          <div style={{display:"flex",gap:6,padding:"0 16px 10px",overflowX:"auto"}}>
            {["ì „ì²´",...cats].map(cat=>{
              const mt = cat==="ì „ì²´" ? null : CAT_META[cat];
              const cl = mt?.color || c.accent;
              const active = filterCat===cat;
              return (
                <button key={cat} onClick={()=>setFilterCat(cat)}
                  style={{
                    background: active ? (cat==="ì „ì²´" ? c.accent : cl) : c.surface2,
                    color: active ? "#fff" : c.muted,
                    border: `1.5px solid ${active?(cat==="ì „ì²´"?c.accent:cl):c.border}`,
                    borderRadius:20, padding:"6px 14px", cursor:"pointer",
                    fontFamily:ff, fontSize:13, fontWeight:active?700:400,
                    flexShrink:0, whiteSpace:"nowrap",
                  }}>
                  {cat==="ì „ì²´" ? "ì „ì²´" : `${mt?.icon||""} ${cat}`}
                </button>
              );
            })}
          </div>
        </div>
      )}

      {/* ìŠ¤í¬ë¡¤ ì˜ì—­ */}
      <div style={{flex:1,overflowY:"auto",padding:"14px"}}>
        {screen!=="search" && (
          <Calendar memos={memos} c={c} font={font}
            onDateClick={d=>{ setSelDate(d); setCatPop(true); }}/>
        )}

        <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12}}>
          <button onClick={()=>{ setSelDate(null); setCatPop(true); }}
            style={{background:c.accent,color:"#fff",border:"none",borderRadius:10,
              padding:"10px 18px",cursor:"pointer",fontFamily:ff,fontWeight:700,
              fontSize:15,display:"flex",alignItems:"center",gap:6}}>
            âœï¸ ë©”ëª¨ì‘ì„±
          </button>
          <span style={{fontSize:12,color:c.muted}}>{filtered.length}ê°œ</span>
        </div>

        {filtered.length===0 ? (
          <div style={{textAlign:"center",color:c.muted,padding:"48px 0"}}>
            <div style={{fontSize:44,marginBottom:12}}>ğŸ““</div>
            <div style={{fontSize:14,lineHeight:1.8}}>ì•„ì§ ë©”ëª¨ê°€ ì—†ì–´ìš”<br/>ì²« ë©”ëª¨ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</div>
          </div>
        ) : (
          <div style={{display:"flex",flexDirection:"column",gap:10}}>
            {filtered.map(m=>{
              const mt=CAT_META[m.category], cl=mt?.color||"#94a3b8";
              return (
                <div key={m.id} onClick={()=>openEdit(m)}
                  style={{background:c.surface,border:`1px solid ${c.border}`,
                    borderRadius:14,padding:"13px 14px",cursor:"pointer",
                    borderLeft:`4px solid ${cl}`}}>
                  <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:5}}>
                    <div style={{display:"flex",alignItems:"center",gap:6}}>
                      <span style={{fontSize:10,fontWeight:700,color:cl,
                        background:isDark?"rgba(255,255,255,0.07)":"rgba(0,0,0,0.06)",
                        padding:"2px 8px",borderRadius:20}}>
                        {mt?.icon||"ğŸ—‚ï¸"} {m.category}
                      </span>
                      {m.weather&&<span style={{fontSize:13}}>{m.weather.icon}</span>}
                    </div>
                    <span style={{fontSize:12,color:c.muted}}>
                      {m.date.getMonth()+1}/{m.date.getDate()}
                    </span>
                  </div>
                  <div style={{fontWeight:700,fontSize:15,marginBottom:4,color:c.text}}>{m.title}</div>
                  <div style={{fontSize:13,color:c.muted,overflow:"hidden",
                    textOverflow:"ellipsis",whiteSpace:"nowrap"}}>
                    {m.content||"(ë‚´ìš© ì—†ìŒ)"}
                  </div>
                  {m.images?.length>0 &&
                    <div style={{fontSize:12,color:c.muted,marginTop:4}}>ğŸ“· {m.images.length}ì¥</div>}
                </div>
              );
            })}
          </div>
        )}

        <div style={{textAlign:"center",fontSize:11,color:c.muted,padding:"24px 0 8px"}}>ì‘ì€ì•±ê³µë°©</div>
      </div>

      {/* ì¹´í…Œê³ ë¦¬ íŒì—… */}
      {catPop && (
        <div onClick={()=>setCatPop(false)}
          style={{position:"fixed",inset:0,background:"rgba(0,0,0,0.65)",
            zIndex:200,display:"flex",alignItems:"flex-end",justifyContent:"center"}}>
          <div onClick={e=>e.stopPropagation()}
            style={{background:c.surface,borderRadius:"20px 20px 0 0",
              padding:"20px 20px 36px",width:"100%",maxWidth:480}}>
            <div style={{width:36,height:4,background:c.border,borderRadius:2,margin:"0 auto 16px"}}/>
            <div style={{textAlign:"center",fontSize:15,fontWeight:700,color:c.text,marginBottom:8,fontFamily:ff}}>
              ì–´ë–¤ ì¢…ë¥˜ì˜ ë©”ëª¨ì¸ê°€ìš”?
            </div>
            {selDate && (
              <div style={{textAlign:"center",fontSize:12,color:c.muted,marginBottom:16}}>
                {fmtDate(selDate)}
              </div>
            )}
            <div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:10}}>
              {cats.map(cat=>{
                const mt=CAT_META[cat], cl=mt?.color||"#94a3b8";
                return (
                  <button key={cat} onClick={()=>startWrite(cat,selDate)}
                    style={{background:isDark?"rgba(255,255,255,0.05)":c.surface2,
                      border:`2px solid ${cl}`,borderRadius:14,
                      padding:"14px 8px",cursor:"pointer",color:c.text,fontFamily:ff,fontWeight:700,
                      display:"flex",flexDirection:"column",alignItems:"center",gap:6}}>
                    <span style={{fontSize:26}}>{mt?.icon||"ğŸ—‚ï¸"}</span>
                    <span style={{fontSize:13}}>{cat}</span>
                  </button>
                );
              })}
            </div>
          </div>
        </div>
      )}
    </div>
  );

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ë©”ëª¨ ì‘ì„± í™”ë©´
  // í•µì‹¬: ì „ì²´ê°€ ìŠ¤í¬ë¡¤ë˜ëŠ” ë‹¨ìˆœ êµ¬ì¡°
  // fixed/sticky ì¼ì ˆ ì—†ìŒ â†’ í‚¤ë³´ë“œ íŠ•ê¹€ ì›ì²œ ì°¨ë‹¨
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (screen==="write") {
    const mt=CAT_META[wCat], cl=mt?.color||"#94a3b8";
    return (
      <div style={{fontFamily:ff,background:c.bg,color:c.text,
        width:"100%",minHeight:"100%",display:"flex",flexDirection:"column"}}>

        <TopBar
          left={
            <button onClick={()=>setScreen("main")}
              style={{background:"none",border:"none",color:c.accent,
                cursor:"pointer",fontFamily:ff,fontSize:16,padding:"4px 0"}}>
              â€¹ ë’¤ë¡œ
            </button>
          }
          title={`${mt?.icon||"ğŸ—‚ï¸"} ${wCat}`}
          right={editMemo && <IBtn ch="ğŸ—‘ï¸" onClick={()=>doDelete(editMemo.id)}/>}
        />

        {/* ì „ì²´ ìŠ¤í¬ë¡¤ ì˜ì—­ - ë²„íŠ¼ í¬í•¨ */}
        <div style={{flex:1,overflowY:"auto",WebkitOverflowScrolling:"touch"}}>
          <div style={{padding:"16px 16px 0"}}>

            {/* ë‚ ì§œ */}
            <div style={{fontSize:13,color:c.muted,marginBottom:12,fontWeight:500}}>
              {fmtDate(selDate||new Date())}
            </div>

            {/* ì¼ê¸°: ë‚ ì”¨ */}
            {wCat==="ì¼ê¸°" && (
              <div style={{marginBottom:16}}><WBadge/></div>
            )}

            {/* ì•½ì†: ë‚ ì§œ/ì‹œê°„ ì…ë ¥ */}
            {wCat==="ì•½ì†" && (
              <div style={{marginBottom:16,padding:"12px 14px",
                background:isDark?"rgba(167,139,250,0.1)":"#f3f0ff",
                borderRadius:12,border:`1px solid ${isDark?"rgba(167,139,250,0.3)":"#c4b5fd"}`}}>
                <div style={{fontSize:13,color:"#a78bfa",fontWeight:700,marginBottom:10}}>
                  ğŸ“… ì•½ì† ì¼ì‹œ
                </div>
                <div style={{display:"flex",gap:8,alignItems:"center"}}>
                  <input
                    type="date"
                    value={wApptDate}
                    onChange={e=>setWApptDate(e.target.value)}
                    autoComplete="off"
                    style={{flex:1,background:c.surface2,border:`1px solid ${c.border}`,
                      borderRadius:8,padding:"9px 10px",color:c.text,fontFamily:ff,
                      fontSize:"16px",outline:"none"}}
                  />
                  <input
                    type="time"
                    value={wApptTime}
                    onChange={e=>setWApptTime(e.target.value)}
                    autoComplete="off"
                    style={{flex:1,background:c.surface2,border:`1px solid ${c.border}`,
                      borderRadius:8,padding:"9px 10px",color:c.text,fontFamily:ff,
                      fontSize:"16px",outline:"none"}}
                  />
                </div>
                <div style={{fontSize:11,color:c.muted,marginTop:8}}>
                  â° ì„¤ì •í•œ ì‹œê°„ 1ì‹œê°„ ì „ì— ì•Œë¦¼ì„ ë“œë ¤ìš”
                </div>
              </div>
            )}

            {/* â˜… ì œëª© ì…ë ¥ - í‚¤ë³´ë“œ íŠ•ê¹€ ë°©ì§€ í•µì‹¬ â˜…
                autoComplete/autoCorrect/autoCapitalize ëª¨ë‘ off
                font-size ë°˜ë“œì‹œ 16px ì´ìƒ */}
            <input
              type="text"
              value={wTitle}
              onChange={e=>setWTitle(e.target.value)}
              placeholder="ì œëª©"
              autoComplete="off"
              autoCorrect="off"
              autoCapitalize="off"
              spellCheck="false"
              style={{
                display:"block", width:"100%",
                background:"transparent", border:"none",
                borderBottom:`2px solid ${cl}`,
                padding:"10px 0", marginBottom:16,
                fontFamily:ff, fontSize:"18px", fontWeight:700,
                color:c.text, outline:"none",
              }}
            />

            {/* â˜… ë‚´ìš© ì…ë ¥ - ìë™ ë†’ì´ í™•ì¥ â˜… */}
            <textarea
              value={wContent}
              onChange={e=>{
                setWContent(e.target.value);
                // ìë™ ë†’ì´ í™•ì¥
                e.target.style.height = "auto";
                e.target.style.height = e.target.scrollHeight + "px";
              }}
              placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."
              autoComplete="off"
              autoCorrect="off"
              autoCapitalize="off"
              spellCheck="false"
              style={{
                display:"block", width:"100%",
                background:"transparent", border:"none",
                resize:"none", fontFamily:ff,
                fontSize:"16px", lineHeight:1.9,
                color:c.text, outline:"none",
                minHeight:200, overflow:"hidden",
              }}
            />

            {/* ì‚¬ì§„ - ë‚´ìš© ë°”ë¡œ ì•„ë˜ ê°€ë¡œ ì „ì²´ ë„ˆë¹„ */}
            {wImages.length>0 && (
              <div style={{display:"flex",flexDirection:"column",gap:10,marginTop:8}}>
                {wImages.map((img,i)=>(
                  <div key={i} style={{position:"relative",width:"100%"}}>
                    <img src={img} alt=""
                      style={{
                        width:"100%", height:"auto",
                        maxHeight:360, objectFit:"cover",
                        borderRadius:14,
                        border:`1.5px solid ${c.border}`,
                        display:"block",
                      }}/>
                    <button onClick={()=>setWImages(p=>p.filter((_,j)=>j!==i))}
                      style={{
                        position:"absolute", top:8, right:8,
                        background:"rgba(0,0,0,0.55)", color:"#fff",
                        border:"none", borderRadius:"50%",
                        width:30, height:30, cursor:"pointer",
                        fontSize:18, lineHeight:"30px", textAlign:"center",
                        fontWeight:700,
                      }}>Ã—</button>
                  </div>
                ))}
                {/* ì‚¬ì§„ ì¶”ê°€ ë²„íŠ¼ */}
                <button onClick={()=>fileRef.current?.click()}
                  style={{
                    width:"100%", padding:"14px",
                    background:c.surface2,
                    border:`2px dashed ${c.border}`,
                    borderRadius:14, cursor:"pointer",
                    display:"flex", alignItems:"center",
                    justifyContent:"center", gap:8,
                    color:c.muted, fontFamily:ff, fontSize:14,
                  }}>
                  <span style={{fontSize:20}}>ğŸ“·</span>
                  <span>ì‚¬ì§„ ì¶”ê°€</span>
                </button>
              </div>
            )}
          </div>

          {/* í•˜ë‹¨ ë²„íŠ¼ - ìŠ¤í¬ë¡¤ ë‚´ë¶€ì— ìì—°ìŠ¤ëŸ½ê²Œ í¬í•¨ */}
          <div style={{
            margin:"20px 16px 0",
            padding:"14px 0",
            borderTop:`1px solid ${c.border}`,
            display:"flex", gap:8,
            justifyContent:"flex-end", alignItems:"center",
          }}>
            {editMemo && (
              <button onClick={()=>doShare(editMemo)}
                style={{background:"#FEE500",color:"#3C1E1E",border:"none",
                  borderRadius:10,padding:"10px 14px",cursor:"pointer",
                  fontFamily:ff,fontWeight:700,fontSize:14,marginRight:"auto"}}>
                ğŸ’¬ ê³µìœ 
              </button>
            )}
            <GBtn ch="ì·¨ì†Œ" onClick={()=>setScreen("main")}/>
            <GBtn ch="ğŸ“·" onClick={()=>fileRef.current?.click()}/>
            <input ref={fileRef} type="file" accept="image/*" multiple
              onChange={onImg} style={{display:"none"}}/>
            <PBtn ch="ì €ì¥" onClick={doSave}/>
          </div>

          <div style={{textAlign:"center",fontSize:11,color:c.muted,padding:"16px 0 24px"}}>
            ì‘ì€ì•±ê³µë°©
          </div>
        </div>
      </div>
    );
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ì„¤ì • í™”ë©´
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (screen==="settings") {
    const Sec = ({t}) => (
      <div style={{fontSize:11,color:c.muted,fontWeight:700,letterSpacing:1,
        textTransform:"uppercase",marginTop:24,marginBottom:8,fontFamily:ff}}>{t}</div>
    );
    const Row = ({icon,label,right}) => (
      <div style={{background:c.surface,border:`1px solid ${c.border}`,borderRadius:12,
        padding:"14px",marginBottom:8,display:"flex",alignItems:"center",justifyContent:"space-between"}}>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          {icon && <span style={{fontSize:18}}>{icon}</span>}
          <span style={{fontSize:15,color:c.text,fontFamily:ff}}>{label}</span>
        </div>
        {right}
      </div>
    );
    const Toggle = ({val,onChange}) => (
      <button onClick={()=>onChange(!val)}
        style={{background:val?c.accent:"#4b5563",border:"none",borderRadius:20,
          width:48,height:28,cursor:"pointer",position:"relative",transition:"background 0.2s",flexShrink:0}}>
        <div style={{width:22,height:22,background:"#fff",borderRadius:"50%",
          position:"absolute",top:3,left:val?23:3,transition:"left 0.2s"}}/>
      </button>
    );
    return (
      <div style={{fontFamily:ff,background:c.bg,color:c.text,
        width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"}}>
        <TopBar
          left={
            <button onClick={()=>setScreen("main")}
              style={{background:"none",border:"none",color:c.accent,
                cursor:"pointer",fontFamily:ff,fontSize:16,padding:"4px 0"}}>
              â€¹ ë’¤ë¡œ
            </button>
          }
          title="ì„¤ì •"
          right={null}
        />
        <div style={{flex:1,overflowY:"auto",padding:"4px 16px 40px"}}>
          <Sec t="í…Œë§ˆ"/>
          <Row icon="ğŸŒ™" label="ë‹¤í¬ ëª¨ë“œ" right={<Toggle val={isDark} onChange={setIsDark}/>}/>

          <Sec t="í°íŠ¸"/>
          <Row icon="ğŸ”¤" label="í°íŠ¸" right={
            <select value={font} onChange={e=>setFont(e.target.value)}
              style={{background:c.surface2,border:`1px solid ${c.border}`,borderRadius:8,
                padding:"6px 8px",color:c.text,fontFamily:ff}}>
              {FONTS.map(f=><option key={f} value={f}>{f}</option>)}
            </select>
          }/>
          <Row icon="ğŸ”¡" label="ê¸€ì”¨ í¬ê¸°" right={
            <div style={{display:"flex",alignItems:"center",gap:10}}>
              <button onClick={()=>setFSize(s=>Math.max(12,s-1))}
                style={{background:c.surface2,border:`1px solid ${c.border}`,color:c.text,
                  borderRadius:8,padding:"6px 14px",cursor:"pointer",fontFamily:ff,fontSize:16}}>âˆ’</button>
              <span style={{color:c.text,minWidth:28,textAlign:"center",fontFamily:ff}}>{fSize}</span>
              <button onClick={()=>setFSize(s=>Math.min(22,s+1))}
                style={{background:c.surface2,border:`1px solid ${c.border}`,color:c.text,
                  borderRadius:8,padding:"6px 14px",cursor:"pointer",fontFamily:ff,fontSize:16}}>+</button>
            </div>
          }/>

          <Sec t="ë©”ëª¨ ì¢…ë¥˜"/>
          <div style={{background:c.surface,border:`1px solid ${c.border}`,borderRadius:12,
            padding:"12px 14px",marginBottom:8}}>
            {cats.map(cat=>{
              const mt=CAT_META[cat], cl=mt?.color||"#94a3b8";
              return (
                <div key={cat} style={{display:"flex",justifyContent:"space-between",
                  alignItems:"center",padding:"9px 0",borderBottom:`1px solid ${c.border}`}}>
                  <span style={{color:c.text,fontSize:15,display:"flex",alignItems:"center",gap:8}}>
                    <span style={{width:10,height:10,borderRadius:"50%",
                      background:cl,display:"inline-block"}}/>
                    {mt?.icon||"ğŸ—‚ï¸"} {cat}
                  </span>
                  {!DEFAULT_CATS.includes(cat) && (
                    <button onClick={()=>setCats(p=>p.filter(x=>x!==cat))}
                      style={{background:"none",border:"none",color:c.danger,
                        cursor:"pointer",fontSize:20,lineHeight:1}}>Ã—</button>
                  )}
                </div>
              );
            })}
            <div style={{display:"flex",gap:8,marginTop:12}}>
              <input value={newCat} onChange={e=>setNewCat(e.target.value)}
                onKeyDown={e=>{
                  if(e.key==="Enter"&&newCat.trim()&&!cats.includes(newCat.trim())) {
                    setCats(p=>[...p,newCat.trim()]); setNewCat("");
                  }
                }}
                placeholder="ìƒˆ ì¢…ë¥˜ ì¶”ê°€..."
                style={{flex:1,background:c.surface2,border:`1px solid ${c.border}`,
                  borderRadius:8,padding:"10px",color:c.text,fontFamily:ff,outline:"none"}}/>
              <PBtn ch="ì¶”ê°€" onClick={()=>{
                if(newCat.trim()&&!cats.includes(newCat.trim())) {
                  setCats(p=>[...p,newCat.trim()]); setNewCat("");
                }
              }} style={{padding:"10px 14px"}}/>
            </div>
          </div>

          <Sec t="ê³µìœ "/>
          <div onClick={()=>{
            if(navigator.share) navigator.share({title:"ë©”ëª¨ì¥",url:window.location.href});
            else alert("ì¹´ì¹´ì˜¤í†¡ ì•± ì—°ë™ì€ ì‹¤ì œ ë°°í¬ ì‹œ ì„¤ì •ë©ë‹ˆë‹¤.");
          }}
            style={{background:"#FEE500",borderRadius:12,padding:"14px",cursor:"pointer",
              display:"flex",alignItems:"center",gap:10,marginBottom:8}}>
            <span style={{fontSize:20}}>ğŸ’¬</span>
            <span style={{color:"#3C1E1E",fontWeight:700,fontSize:15,fontFamily:ff}}>ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê³µìœ í•˜ê¸°</span>
          </div>

          <Sec t="ë°ì´í„°"/>
          <Row icon="ğŸ“Š" label={`ì €ì¥ëœ ë©”ëª¨: ${memos.length}ê°œ`} right={null}/>
          <div onClick={()=>{
            if(window.confirm("ëª¨ë“  ë©”ëª¨ë¥¼ ì‚­ì œí• ê¹Œìš”?")) { setMemos([]); saveMemos([]); }
          }}
            style={{background:c.surface,border:`1px solid ${c.danger}`,borderRadius:12,
              padding:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:10}}>
            <span style={{fontSize:18}}>ğŸ—‘ï¸</span>
            <span style={{color:c.danger,fontSize:15,fontWeight:600,fontFamily:ff}}>ëª¨ë“  ë©”ëª¨ ì‚­ì œ</span>
          </div>

          <div style={{textAlign:"center",marginTop:32,fontSize:12,color:c.muted}}>
            ë©”ëª¨ì¥ v1.0 Â· ì‘ì€ì•±ê³µë°©
          </div>
        </div>
      </div>
    );
  }

  return null;
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);

if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("/memoapp/sw.js")
      .then(r=>console.log("SW:", r.scope))
      .catch(e=>console.log("SW ì˜¤ë¥˜:", e));
  });
}
</script>
</body>
</html>
